// ==UserScript==
// @name         16ËøõÂà∂È¢úËâ≤È¢ÑËßà‰∏éÊü•ËØ¢Â∑•ÂÖ∑
// @namespace    http://tampermonkey.net/
// @version      2.4.2
// @description  Êèê‰æõ16ËøõÂà∂È¢úËâ≤È¢ÑËßà„ÄÅË∞ÉËØïÂèäÂÖ®ÁΩëÂ∏∏ËßÅÈ¢úËâ≤Â±ïÁ§∫ÔºåÈ¢úËâ≤ÊåâÁ∫¢„ÄÅÁ≤â„ÄÅÊ©ô„ÄÅÈªÑ„ÄÅÁªø„ÄÅÈùí„ÄÅËìù„ÄÅÁ¥´„ÄÅÈªëÁôΩ„ÄÅÈÄèÊòéÂàÜÁªÑÊéíÂ∫èÔºåÊîØÊåÅÊ∑±Ëâ≤/ÊµÖËâ≤/Ëá™Âä®ÈÄÇÂ∫îÁ≥ªÁªü‰∏ªÈ¢òÂèäÊêúÁ¥¢Á≠õÈÄâÂäüËÉΩÔºåÈÄÇÈÖçÁ´ñÂ±è(ÁßªÂä®Á´Ø)‰∏éÊ®™Â±è(PCÁ´Ø)„ÄÇ
// @author       ChatGPT
// @match        *://*/*
// @grant        GM_registerMenuCommand
// ==/UserScript==

(function() {
    'use strict';

    // ========== È¢úËâ≤ÂàÜÁªÑÊï∞ÊçÆ ==========
    // Êñ∞ÊéíÂ∫èÔºöÁ∫¢ ‚Üí Á≤â ‚Üí Ê©ô ‚Üí ÈªÑ ‚Üí Áªø ‚Üí Èùí ‚Üí Ëìù ‚Üí Á¥´ ‚Üí ÈªëÁôΩ ‚Üí ÈÄèÊòé
    const colorGroups = [
        {
            group: "Á∫¢Ëâ≤ üî¥",
            colors: [
                { code: "#FF0000", name: "Á∫¢Ëâ≤" },
                { code: "#DC143C", name: "Áå©Á∫¢" },
                { code: "#B22222", name: "ÁÅ´Á†ñÁ∫¢" },
                { code: "#8B0000", name: "Ê∑±Á∫¢" },
                { code: "#FF4500", name: "Ê©ôÁ∫¢" },
                { code: "#FF6347", name: "Áï™ËåÑÁ∫¢" }
            ]
        },
        {
            group: "Á≤âËâ≤Á≥ª üíó",
            colors: [
                { code: "#FFC0CB", name: "Á≤âËâ≤" },
                { code: "#F7CAC9", name: "Ê®±Ëä±Á≤â" },
                { code: "#FFB6C1", name: "ÊµÖÁ≤âËâ≤" },
                { code: "#FF69B4", name: "ÁÉ≠ÊÉÖÁ≤â" },
                { code: "#FF1493", name: "Ê∑±Á≤â" },
                { code: "#C71585", name: "‰∏≠Á¥´Á∫¢" },
                { code: "#DB7093", name: "Ê∑°Áé´Áë∞Ëâ≤" },
                { code: "#FF007F", name: "Áé´Áë∞Á∫¢" },
                { code: "#FA8072", name: "È≤ëÈ±ºÁ≤â" },
                { code: "#B0C7E2", name: "ÁÅ∞ÈõæËìùÁ≤â" }
            ]
        },
        {
            group: "Ê©ôËâ≤ üü†",
            colors: [
                { code: "#FFA500", name: "Ê©ôËâ≤" },
                { code: "#FF8C00", name: "Ê∑±Ê©ô" },
                { code: "#FF7F50", name: "ÁèäÁëöÊ©ô" }
            ]
        },
        {
            group: "ÈªÑËâ≤ üü°",
            colors: [
                { code: "#FFFF00", name: "ÈªÑËâ≤" },
                { code: "#FFD700", name: "ÈáëÈªÑ" },
                { code: "#FFFFE0", name: "ÊµÖÈªÑËâ≤" },
                { code: "#FFFACD", name: "Êü†Ê™¨Áª∏" },
                { code: "#F0E68C", name: "Âç°ÂÖ∂Ëâ≤" },
                { code: "#FFE4B5", name: "ÈπøÁöÆËâ≤" },
                { code: "#FFDAB9", name: "Ê°ÉËâ≤" }
            ]
        },
        {
            group: "ÁªøËâ≤ üü¢",
            colors: [
                { code: "#008000", name: "ÁªøËâ≤" },
                { code: "#00FF00", name: "ÈÖ∏Ê©ôÁªø" },
                { code: "#228B22", name: "Ê£ÆÊûóÁªø" },
                { code: "#32CD32", name: "ÈÖ∏Ê©ôÁªø (LimeGreen)" },
                { code: "#90EE90", name: "Ê∑°ÁªøËâ≤" },
                { code: "#3CB371", name: "Êµ∑Ê¥ãÁªø" },
                { code: "#2E8B57", name: "Êµ∑Áªø" },
                { code: "#006400", name: "Ê∑±ÁªøËâ≤" },
                { code: "#00FF7F", name: "Êò•Áªø" },
                { code: "#C7EDCC", name: "Ë±ÜÊ≤ôÁªø" },
                { code: "#98FB98", name: "ËãçÁªøËâ≤" }
            ]
        },
        {
            group: "ÈùíËâ≤ üîµ",
            colors: [
                { code: "#00FFFF", name: "ÈùíËâ≤" },
                { code: "#E0FFFF", name: "Ê∑°ÈùíËâ≤" },
                { code: "#40E0D0", name: "ÁªøÊùæÁü≥" },
                { code: "#48D1CC", name: "‰∏≠ÁªøÊùæÁü≥" },
                { code: "#00CED1", name: "ÊöóÁªøÊùæÁü≥" },
                { code: "#7FFFD4", name: "Ê∞¥ÁªøÂÆùÁü≥" },
                { code: "#AFEEEE", name: "Á¢ßÁªøËâ≤" }
            ]
        },
        {
            group: "ËìùËâ≤ üî∑",
            colors: [
                { code: "#0000FF", name: "ËìùËâ≤" },
                { code: "#4169E1", name: "ÁöáÂÆ∂Ëìù" },
                { code: "#1E90FF", name: "ÈÅìÂ•áËìù" },
                { code: "#00BFFF", name: "Ê∑±Â§©Ëìù" },
                { code: "#87CEEB", name: "Â§©Ëìù" },
                { code: "#87CEFA", name: "Ê∑°Â§©Ëìù" },
                { code: "#4682B4", name: "Èí¢Ëìù" },
                { code: "#ADD8E6", name: "Ê∑°ËìùËâ≤" },
                { code: "#B0E0E6", name: "Á≤âËìù" },
                { code: "#191970", name: "ÂçàÂ§úËìù" },
                { code: "#000080", name: "ËóèÈùíËâ≤" }
            ]
        },
        {
            group: "Á¥´Ëâ≤ üü£",
            colors: [
                { code: "#800080", name: "Á¥´Ëâ≤" },
                { code: "#EE82EE", name: "Á¥´ÁΩóÂÖ∞" },
                { code: "#DA70D6", name: "ÂÖ∞Ëä±Á¥´" },
                { code: "#DDA0DD", name: "ÊùéÂ≠êÁ¥´" },
                { code: "#9370DB", name: "‰∏≠Á¥´" },
                { code: "#8A2BE2", name: "ËìùÁ¥´Ëâ≤" },
                { code: "#9400D3", name: "Ê∑±Á¥´ÁΩóÂÖ∞" },
                { code: "#9932CC", name: "ÊöóÂÖ∞Ëä±Á¥´" },
                { code: "#8B008B", name: "ÊöóÂìÅÁ∫¢" },
                { code: "#4B0082", name: "ÈùõËìù" },
                { code: "#BA55D3", name: "‰∏≠ÂÖ∞Ëä±Á¥´" },
                { code: "#D8BFD8", name: "ËìüËâ≤" }
            ]
        },
        {
            group: "ÈªëÁôΩ ‚ö´‚ö™",
            colors: [
                { code: "#000000", name: "ÈªëËâ≤" },
                { code: "#808080", name: "ÁÅ∞Ëâ≤" },
                { code: "#C0C0C0", name: "Èì∂Ëâ≤" },
                { code: "#FFFFFF", name: "ÁôΩËâ≤" }
            ]
        },
        {
            group: "ÈÄèÊòéËâ≤ üü§",
            colors: [
                { code: "#00000000", name: "ÈÄèÊòéÈªë" },
                { code: "#FFFFFF00", name: "ÈÄèÊòéÁôΩ" },
                { code: "#00000080", name: "ÂçäÈÄèÊòéÈªë" }
            ]
        }
    ];

    // Â∞ÜÈ¢úËâ≤Êò†Â∞ÑÊàê { "#XXXXXX": "ÂêçÁß∞" } ÁªìÊûÑÔºå‰æõË∞ÉËØïÂäüËÉΩÂø´ÈÄüÊü•Êâæ
    const colorMapping = {};
    colorGroups.forEach(group => {
        group.colors.forEach(item => {
            colorMapping[item.code.toUpperCase()] = item.name;
        });
    });

    // Â∑•ÂÖ∑ÂáΩÊï∞ÔºöÂàõÂª∫ÂÖÉÁ¥†
    function createElement(tag, className, innerHTML) {
        const el = document.createElement(tag);
        if (className) el.className = className;
        if (innerHTML) el.innerHTML = innerHTML;
        return el;
    }

    // Ê∑ªÂä†ÂÖ®Â±ÄÊ†∑Âºè
    function addGlobalStyle(css) {
        const head = document.head || document.getElementsByTagName('head')[0];
        if (!head) return;
        const style = document.createElement('style');
        style.type = 'text/css';
        style.innerHTML = css;
        head.appendChild(style);
    }

    const globalCSS = `
    :root {
      --bg-overlay: rgba(0,0,0,0.7);
      --modal-bg: #fff;
      --modal-text: #333;
      --input-bg: #fff;
      --input-text: #333;
      --border-color: #ccc;
      --button-bg: #007BFF;
      --button-text: #fff;
    }
    /* Ëá™Âä®ÈÄÇÈÖçÁ≥ªÁªüÊ∑±Ëâ≤Ê®°Âºè */
    @media (prefers-color-scheme: dark) {
      :root {
        --bg-overlay: rgba(0,0,0,0.85);
        --modal-bg: #1e1e1e;
        --modal-text: #e0e0e0;
        --input-bg: #333;
        --input-text: #e0e0e0;
        --border-color: #555;
        --button-bg: #0A84FF;
        --button-text: #fff;
      }
    }
    /* ÊâãÂä®ÊµÖËâ≤Ê®°Âºè */
    .theme-light {
      --bg-overlay: rgba(0,0,0,0.7);
      --modal-bg: #fff;
      --modal-text: #333;
      --input-bg: #fff;
      --input-text: #333;
      --border-color: #ccc;
      --button-bg: #007BFF;
      --button-text: #fff;
    }
    /* ÊâãÂä®Ê∑±Ëâ≤Ê®°Âºè */
    .theme-dark {
      --bg-overlay: rgba(0,0,0,0.85);
      --modal-bg: #1e1e1e;
      --modal-text: #e0e0e0;
      --input-bg: #333;
      --input-text: #e0e0e0;
      --border-color: #555;
      --button-bg: #0A84FF;
      --button-text: #fff;
    }
    .color-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--bg-overlay);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
        font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
    }
    .color-modal {
        background: var(--modal-bg);
        color: var(--modal-text);
        border-radius: 10px;
        box-shadow: 0 4px 20px rgba(0,0,0,0.3);
        padding: 20px;
        max-width: 95%;
        max-height: 95%;
        overflow-y: auto;
        position: relative;
    }
    .color-modal h2 {
        margin-top: 0;
        font-size: 26px;
        text-align: center;
        margin-bottom: 20px;
    }
    .theme-toggle {
        position: absolute;
        top: 10px;
        left: 10px;
        padding: 5px 10px;
        border: none;
        border-radius: 5px;
        background: var(--button-bg);
        color: var(--button-text);
        cursor: pointer;
        font-size: 14px;
    }
    .close-button {
        position: absolute;
        top: 10px;
        right: 10px;
        background: var(--modal-text);
        color: var(--modal-bg);
        border: none;
        border-radius: 5px;
        padding: 5px 10px;
        cursor: pointer;
        font-size: 14px;
    }
    .color-group {
        margin-bottom: 30px;
    }
    .group-title {
        font-size: 20px;
        font-weight: bold;
        margin-bottom: 10px;
        border-bottom: 1px solid var(--border-color);
        padding-bottom: 5px;
    }
    .color-item {
        display: inline-block;
        width: 120px;
        margin: 10px;
        text-align: center;
        position: relative;
    }
    .color-swatch {
        width: 120px;
        height: 120px;
        line-height: 120px;
        border-radius: 8px;
        color: var(--modal-bg);
        font-weight: bold;
        margin-bottom: 5px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        cursor: pointer;
    }
    .toggle-container {
        margin: 10px 0;
        display: flex;
        align-items: center;
        justify-content: center;
    }
    .toggle-container label {
        margin-left: 5px;
        font-size: 16px;
    }
    .close-button:hover,
    .theme-toggle:hover {
        opacity: 0.85;
    }
    .input-group {
        margin: 10px 0;
        text-align: center;
    }
    .input-group input {
        width: 60%;
        padding: 8px;
        font-size: 16px;
        background: var(--input-bg);
        color: var(--input-text);
        border: 1px solid var(--border-color);
        border-radius: 5px;
    }
    .input-group button {
        padding: 8px 16px;
        font-size: 16px;
        margin-left: 10px;
        border: none;
        border-radius: 5px;
        background: var(--button-bg);
        color: var(--button-text);
        cursor: pointer;
    }
    .search-group {
        margin: 10px 0 20px 0;
        text-align: center;
    }
    .search-group input {
        width: 70%;
        padding: 8px;
        font-size: 16px;
        border: 1px solid var(--border-color);
        border-radius: 5px;
        background: var(--input-bg);
        color: var(--input-text);
    }
    .copy-tooltip {
        pointer-events: none;
        opacity: 0.9;
    }

    /* Á´ñÂ±è‰∏ãÔºöËÆ©ÂàóË°®Â±Ö‰∏≠ & ‰øùÊåÅÂÖ≥Èó≠/‰∏ªÈ¢òÊåâÈíÆÂÆö‰Ωç */
    @media only screen and (orientation: portrait) {
      .preview-container, .content-container {
        text-align: center !important;
      }
      .close-button {
        position: absolute !important;
        top: 10px !important;
        right: 10px !important;
      }
      .theme-toggle {
        position: absolute !important;
        top: 10px !important;
        left: 10px !important;
      }
    }
    `;
    addGlobalStyle(globalCSS);

    // ========== ‰∏ªÈ¢òÊ®°ÂºèÈÄªËæë ==========
    const themeModes = ["auto", "light", "dark"];

    function updateTheme(modal, mode) {
        modal.classList.remove("theme-light", "theme-dark");
        if (mode === "light") {
            modal.classList.add("theme-light");
        } else if (mode === "dark") {
            modal.classList.add("theme-dark");
        }
    }

    function createThemeToggleButton(modal) {
        let currentMode = "auto";
        const btn = createElement("button", "theme-toggle", "‰∏ªÈ¢ò: Ëá™Âä®");
        btn.addEventListener('click', () => {
            const idx = themeModes.indexOf(currentMode);
            currentMode = themeModes[(idx + 1) % themeModes.length];
            btn.innerHTML = "‰∏ªÈ¢ò: " + (
                currentMode === "auto" ? "Ëá™Âä®" :
                currentMode === "light" ? "ÊµÖËâ≤" : "Ê∑±Ëâ≤"
            );
            updateTheme(modal, currentMode);
        });
        modal.appendChild(btn);
    }

    // ========== Ë∞ÉËØï16ËøõÂà∂È¢úËâ≤È¢ÑËßàUI ==========
    function showDebugColorUI() {
        const overlay = createElement('div', 'color-overlay');
        const modal = createElement('div', 'color-modal');
        overlay.appendChild(modal);

        createThemeToggleButton(modal);

        const closeBtn = createElement('button', 'close-button', 'ÂÖ≥Èó≠');
        closeBtn.addEventListener('click', () => document.body.removeChild(overlay));
        modal.appendChild(closeBtn);

        const title = createElement('h2', '', '16ËøõÂà∂È¢úËâ≤È¢ÑËßà‰∏éË∞ÉËØï');
        modal.appendChild(title);

        const inputGroup = createElement('div', 'input-group');
        const inputField = document.createElement('input');
        inputField.type = 'text';
        inputField.placeholder = '‰æãÂ¶ÇÔºö#C7EDCC';
        inputGroup.appendChild(inputField);

        const generateBtn = createElement('button', '', 'ÁîüÊàêÈ¢ÑËßà');
        inputGroup.appendChild(generateBtn);

        const clearBtn = createElement('button', '', 'Ê∏ÖÁ©∫È¢ÑËßà');
        inputGroup.appendChild(clearBtn);

        modal.appendChild(inputGroup);

        const toggleContainer = createElement('div', 'toggle-container');
        const toggleInput = document.createElement('input');
        toggleInput.type = 'checkbox';
        toggleInput.checked = true;
        toggleContainer.appendChild(toggleInput);
        const toggleLabel = createElement('label', '', 'ÊòæÁ§∫È¢úËâ≤ÂêçÁß∞');
        toggleContainer.appendChild(toggleLabel);
        modal.appendChild(toggleContainer);

        const previewContainer = createElement('div', 'preview-container');
        previewContainer.style.textAlign = 'center';
        modal.appendChild(previewContainer);

        generateBtn.addEventListener('click', () => {
            previewContainer.innerHTML = '';
            const inputText = inputField.value.trim();
            if (!inputText) return;
            const codes = inputText.split(',').map(s => s.trim()).filter(s => s.length > 0);
            const regex = /^#?([0-9a-fA-F]{3}|[0-9a-fA-F]{6})$/;
            codes.forEach(origCode => {
                let code = origCode;
                if (!code.startsWith("#")) {
                    code = "#" + code;
                }
                if (!regex.test(code)) {
                    alert("Êó†ÊïàÁöÑÈ¢úËâ≤‰ª£Á†Å: " + code);
                    return;
                }
                code = code.toUpperCase();

                const item = createElement('div', 'color-item');
                const swatch = createElement('div', 'color-swatch', code);
                swatch.style.backgroundColor = code;

                swatch.addEventListener('click', () => {
                    navigator.clipboard.writeText(code).then(() => {
                        const tooltip = createElement('div', 'copy-tooltip', 'Â∑≤Â§çÂà∂');
                        tooltip.style.position = 'absolute';
                        tooltip.style.backgroundColor = 'rgba(0,0,0,0.6)';
                        tooltip.style.color = '#fff';
                        tooltip.style.padding = '2px 5px';
                        tooltip.style.borderRadius = '3px';
                        tooltip.style.fontSize = '12px';
                        tooltip.style.top = '0';
                        tooltip.style.left = '50%';
                        tooltip.style.transform = 'translateX(-50%)';
                        item.appendChild(tooltip);
                        setTimeout(() => {
                            item.removeChild(tooltip);
                        }, 1000);
                    });
                });

                item.appendChild(swatch);

                if (toggleInput.checked) {
                    const nameDiv = createElement('div', '', colorMapping[code] || 'Êú™Áü•È¢úËâ≤');
                    item.appendChild(nameDiv);
                }

                previewContainer.appendChild(item);
            });
        });

        clearBtn.addEventListener('click', () => {
            previewContainer.innerHTML = '';
        });

        document.body.appendChild(overlay);
    }

    // ========== 16ËøõÂà∂È¢úËâ≤Â§ßÂÖ®Â±ïÁ§∫UI ==========
    function showColorCollectionUI() {
        const overlay = createElement('div', 'color-overlay');
        const modal = createElement('div', 'color-modal');
        overlay.appendChild(modal);

        createThemeToggleButton(modal);

        const closeBtn = createElement('button', 'close-button', 'ÂÖ≥Èó≠');
        closeBtn.addEventListener('click', () => document.body.removeChild(overlay));
        modal.appendChild(closeBtn);

        const title = createElement('h2', '', '16ËøõÂà∂È¢úËâ≤Â§ßÂÖ®Â±ïÁ§∫');
        modal.appendChild(title);

        const searchGroup = createElement('div', 'search-group');
        const searchInput = document.createElement('input');
        searchInput.type = 'text';
        searchInput.placeholder = 'ÊêúÁ¥¢È¢úËâ≤Ôºà‰ª£Á†ÅÊàñÂêçÁß∞Ôºâ';
        searchGroup.appendChild(searchInput);
        modal.appendChild(searchGroup);

        const contentContainer = createElement('div', 'content-container');
        modal.appendChild(contentContainer);

        function renderGroups() {
            contentContainer.innerHTML = '';
            colorGroups.forEach(group => {
                const filteredColors = group.colors.filter(item => {
                    const searchTerm = searchInput.value.trim().toLowerCase();
                    if (!searchTerm) return true;
                    return (
                        item.code.toLowerCase().includes(searchTerm) ||
                        item.name.toLowerCase().includes(searchTerm)
                    );
                });
                if (filteredColors.length === 0) return;

                const groupDiv = createElement('div', 'color-group');
                const groupTitle = createElement('div', 'group-title', group.group);
                groupDiv.appendChild(groupTitle);

                filteredColors.forEach(item => {
                    const colorItem = createElement('div', 'color-item');
                    const swatch = createElement('div', 'color-swatch', item.code);
                    swatch.style.backgroundColor = item.code;
                    colorItem.appendChild(swatch);

                    const codeDiv = createElement('div', '', item.code);
                    colorItem.appendChild(codeDiv);

                    const nameDiv = createElement('div', '', item.name);
                    colorItem.appendChild(nameDiv);

                    groupDiv.appendChild(colorItem);
                });

                contentContainer.appendChild(groupDiv);
            });
        }

        renderGroups();
        searchInput.addEventListener('input', renderGroups);

        document.body.appendChild(overlay);
    }

    // ========== Ê≥®ÂÜåÊ≤πÁå¥ËèúÂçï ==========
    if (typeof GM_registerMenuCommand !== "undefined") {
        GM_registerMenuCommand("16ËøõÂà∂È¢úËâ≤È¢ÑËßà‰∏éË∞ÉËØï", showDebugColorUI);
        GM_registerMenuCommand("16ËøõÂà∂È¢úËâ≤Â§ßÂÖ®Â±ïÁ§∫", showColorCollectionUI);
    } else {
        console.error("GM_registerMenuCommand ‰∏çÂèØÁî®„ÄÇ");
    }
})();
